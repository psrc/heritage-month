---
title: "Black History Month ACS Data"
author: "suzanne"
date: "8/19/2021"
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Notes for Black History Month

```{r load_libraries}
library(devtools)
library(sf)
library(dplyr)
library(psrccensus)
library(ggplot2)
library(tidycensus)
Sys.getenv("CENSUS_API_KEY")
```

I searched the api table list for Black to see what data is available.
<https://api.census.gov/data/2019/acs/acs5/variables.html>

How does Black age breakdown compare to non-Black? \* Age is found in
B1002I, B1002A


What specific origins do people come from? \* B300, B05003

Information about grandparents living with grandchildren \* B08105H; I
grandparents B10051I

Are more Black women giving birth than all women? \* B13002 women who
gave birth



```{r}
var_list<- load_variables(2019, "acs5", cache = TRUE)
```


### Median Income

```{r}

income_df_white <- get_acs_recs(geography = 'county',
             table.names = c('B19013H'),
             years=c(2019),
             acs.type = 'acs1')


income_df_Black<- get_acs_recs(geography = 'county',
             table.names = c('B19013B'),
             years=c(2019),
             acs.type = 'acs1')

white_Black_df<-merge(income_df_white, income_df_Black, by ='name')

white_Black_df_formatted<-white_Black_df %>% select(name, estimate.x, moe.x, estimate.y, moe.y) %>% rename(County= name, white_nonhispanic_median_income=estimate.x, white_nonhispanic_median_income_moe=moe.x, black_median_income=estimate.y, black_median_income_moe=moe.y)

white_Black_df
write.table(white_Black_df_formatted,"clipboard", sep='\t', row.names=FALSE )

```
```{r}
homeownership<-get_acs_recs(geography = 'county',
             table.names = c('B25003'),
             years=c(2019),
             acs.type = 'acs1')
write.table(homeownership,"clipboard", sep='\t', row.names=FALSE )


homeownership_white<-get_acs_recs(geography = 'county',
             table.names = c('B25003H'),
             years=c(2019),
             acs.type = 'acs1')
write.table(homeownership_white,"clipboard", sep='\t', row.names=FALSE )

homeownership_black<-get_acs_recs(geography = 'county',
             table.names = c('B25003B'),
             years=c(2019),
             acs.type = 'acs1')
write.table(homeownership_black, "clipboard", sep='\t', row.names=FALSE )
```

### Median Age by Black and All

```{r}

overall_age_df <- get_acs_recs(geography = 'county',
             table.names = c('B01002'),
             years=c(2019),
             acs.type = 'acs5')

Black_age_df<-get_acs_recs(geography = 'county',
             table.names = c('B01002B'),
             years=c(2019),
             acs.type = 'acs5')

Black_age_df_test <- Black_age_df%>% filter(name !='Region' | (!(stringr::str_detect(label, 'Median'))&(stringr::str_detect(label, 'Average'))))

Black_age_df_test2 <- Black_age_df%>% filter(!(stringr::str_detect(label, 'Median')))
                                     
                                     #||
                             #!(stringr::str_detect(label, 'Median')& (stringr::str_detect(label,'Average'))))

overall_Black_df<-rbind(overall_age_df, Black_age_df)
age_df<-overall_Black_df%>% filter(label=='Estimate!!Median age --!!Total:' & name !='Region') %>% mutate('Black'=ifelse(variable=='B01002_001', 'All Population', 'Black Population'))
write.table(age_df,"clipboard", sep='\t', row.names=FALSE )

age_df

ggplot(data=age_df, aes(x=name, y=estimate, fill=Black))+geom_bar(stat='identity', position=position_dodge())+
  geom_text(aes(label=estimate), vjust=1.6, color="white",
            position = position_dodge(0.9), size=3.5)

```

### Women who gave birth

```{r}
women_birth_df<-get_acs_recs(geography = 'county',
             table.names = c('B13002'),
             years=c(2019),
             acs.type = 'acs1') 
women_birth_df_Black<-get_acs_recs(geography = 'county',
             table.names = c('B13002B'),
             years=c(2019),
             acs.type = 'acs5')
women_birth_df
women_birth_df_Black
write.table(women_birth_df,"clipboard", sep='\t', row.names=FALSE )
write.table(women_birth_df_Black,"clipboard", sep='\t', row.names=FALSE )
```

### Poverty Rates

```{r}
poverty_df_white <- get_acs_recs(geography = 'county',
             table.names = c('B17020H'),
             years=c(2019),
             acs.type = 'acs5')


poverty_df_Black<- get_acs_recs(geography = 'county',
             table.names = c('B17020B'),
             years=c(2019),
             acs.type = 'acs5')

poverty_df_white<- poverty_df_white %>% filter(label=='Estimate!!Total:' | label=='Estimate!!Total:!!Income in the past 12 months below poverty level:')%>%select(name, estimate,moe,label)%>%tidyr::pivot_wider(names_from=label,values_from=c(estimate,moe) )

poverty_df_black<- poverty_df_Black %>% filter(label=='Estimate!!Total:' | label=='Estimate!!Total:!!Income in the past 12 months below poverty level:')%>%select(name, estimate,moe,label)%>%tidyr::pivot_wider(names_from=label,values_from=c(estimate,moe) )

poverty_df_black_white<- merge(poverty_df_black, poverty_df_white, by='name')

write.table(poverty_df_black_white,"clipboard", sep='\t', row.names=FALSE )

```



### Means of Transportation to Work
```{r}

```

```{r}

white_transport_df <- get_acs_recs(geography = 'county',
             table.names = c('B08105A'),
             years=c(2019),
             acs.type = 'acs5')%>%filter(name=='Region')



Black_transport_df <- get_acs_recs(geography = 'county',
             table.names = c('B08105B'),
             years=c(2019),
             acs.type = 'acs5')%>%filter(name=='Region')



white_Black_df<-merge(Black_transport_df, white_transport_df, by='label')%>% 
  select(estimate.x, moe.x, label, estimate.y, moe.y)




write.table(white_Black_df,"clipboard", sep='\t', row.names=FALSE )


white_Black_df



```
### Educational Attainment

```{r}

white_df <- get_acs_recs(geography = 'county',
             table.names = c('C15002H'),
             years=c(2019),
             acs.type = 'acs5')%>%filter(name=='Region')



Black_df <- get_acs_recs(geography = 'county',
             table.names = c('C15002B'),
             years=c(2019),
             acs.type = 'acs5')%>%filter(name=='Region')



white_Black_df<-merge(Black_df, white_df, by='label')%>% 
  select(estimate.x, moe.x, label, estimate.y, moe.y)




write.table(white_Black_df,"clipboard", sep='\t', row.names=FALSE )


white_Black_df



```
### B25014, Occupants per room

```{r}
white_df <- get_acs_recs(geography = 'county',
             table.names = c('B25014H'),
             years=c(2019),
             acs.type = 'acs5')



Black_df <- get_acs_recs(geography = 'county',
             table.names = c('B25014B'),
             years=c(2019),
             acs.type = 'acs5')
```





```{r}
white_Black_df<-merge(Black_df, white_df, by='label')%>% 
  select(estimate.x, moe.x, label, estimate.y, moe.y)




write.table(white_Black_df,"clipboard", sep='\t', row.names=FALSE )


white_Black_df



```
```{r}
#Units in Structure
white_df <- get_acs_recs(geography = 'county',
             table.names = c('B25032H'),
             years=c(2019),
             acs.type = 'acs5')



Black_df <- get_acs_recs(geography = 'county',
             table.names = c('B25032B'),
             years=c(2019),
             acs.type = 'acs5')
white_Black_df<-merge(Black_df, white_df, by='label')%>% 
  select(estimate.x, moe.x, label, estimate.y, moe.y)

write.table(white_Black_df,"clipboard", sep='\t', row.names=FALSE )


white_Black_df
```


